@model POS.Models.QuotationVM
@using (Html.BeginForm("Create", "Quotation", FormMethod.Post, new { @id = "quo-form" }))
{
    @Html.AntiForgeryToken()
    @Html.ValidationSummary(true)
    <div class="form-row">
        <div class="form-lable">
            @POS.Resources.Resource.Date
        </div>
        <div class="form-input">
            @Html.TextBoxFor(c => c.Quote.QuoteDate, new { @class = "form-control datepicker" })

        </div>
    </div>
    <div class="form-row">
        <div class="form-lable">
            @POS.Resources.Resource.Location
        </div>
        <div class="form-input">
            @Html.DropDownListFor(c => c.Quote.FKLocationID, Model.getAllLocations(Model.User), new { @class = "form-control", @id = "Sale_FKLocationID" })

        </div>
    </div>
    <div class="form-row">
        <div class="form-lable">
            @POS.Resources.Resource.Customer
            @*<a href="#" onclick="openModel()">

                </a>*@

            @*<button type="button" class="btn btn-primary custombtn" data-toggle="modal" data-target="#cusModal">
                    <img src="~/Content/Images/add.png" />
                </button>*@
        </div>
        <div class="form-input">
            @Html.DropDownListFor(c => c.Quote.FKCustomerID, Model.getAllCustomers(), new { @class = "form-control" })
        </div>
    </div>
    <div class="form-row">
        <div class="form-lable">
            @POS.Resources.Resource.ExpiryDate
        </div>
        <div class="form-input">
            @Html.TextBoxFor(c => c.Quote.QuoteExpiry, new { @class = "form-control datepicker" })

        </div>
    </div>

    <div class="form-row">
        <div class="form-lable">
            @POS.Resources.Resource.Quotation No
        </div>
        <div class="form-input">
            @Html.TextBoxFor(c => c.Quote.ReferenceNumber, new { @class = "form-control", @readonly = "readonly" })

        </div>
    </div>
    <div class="quo-item-main">
        <div style="clear:both;"></div>
        <table class="table table-responsive" id="quotation-items">
            <thead>
                <tr>
                    <th>@POS.Resources.Resource.SaleNo</th>
                    <th>@POS.Resources.Resource.ItemNo</th>
                    <th>@POS.Resources.Resource.Product</th>
                    <th>@POS.Resources.Resource.Quantity</th>
                    <th>@POS.Resources.Resource.MeasuringUnit</th>
                    <th>@POS.Resources.Resource.UnitPrice</th>
                    <th>@POS.Resources.Resource.Total</th>
                    <th></th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>
                        1
                    </td>
                    <td><input type="text" class="form-control item-search" onchange="getItemDetailByNumber(this, 1)" /></td>
                    <td>
                        <input id="Qu-item-0" name="Quote.Items[0].Name" class="sale-items form-control" /> <input type='hidden' class="item-id-hdn" name='Quote.Items[0].FKItemID' />
                    </td>
                    <td>
                        <input type="number" class="form-control sale-item-quantity" onblur="setItemTotal(this)" name="Quote.Items[0].Quantity" required />
                    </td>
                    <td>
                        <div id="Quote_Items0_FkUnitID" class="form-control sale-item-unit"></div>
                    </td>
                    <td>
                        <input type="number" style="display:none;" class="form-control sale-item-base-price" name="Quote.Items[0].BasePrice" />
                        <input type="number" style="display:none;" class="form-control sale-item-changed-price" value="0" name="Quote.Items[0].PriceChanged" />
                        <input type="number" class="form-control sale-item-price" onchange="setItemBasePrice(this)" name="Quote.Items[0].UnitPrice" required />
                    </td>

                    <td>
                        <input type="number" class="form-control sale-item-total" name="Quote.Items[0].Total" readonly />
                    </td>
                    <td><label class='measuring-unit'></label><span class="prices"></span> <span class='image-col'></span> </td>
                    <td><a href='#' onclick='removeRow(this)'><i class="fa fa-trash fa-fw"></i></a></td>
                </tr>
            </tbody>
        </table>
        <input type="button" class="btn btn-warning  custombtn" onclick="addNewRowQoute()" value="@POS.Resources.Resource.AddNewRow" />
    </div>
    <div class="form-row">
        <div class="form-lable">
            @POS.Resources.Resource.SubTotal
        </div>
        <div class="form-input">
            @Html.TextBoxFor(c => c.Quote.SubTotal, new { @class = "form-control quo-sub", @readonly = "readonly" })

        </div>
    </div>
    @*<div class="form-row">
            <div class="form-lable">
                Discount %
            </div>
            <div class="form-input">
                @Html.TextBoxFor(c => c.Quote.Discount, new { @class = "form-control quo-dis", @onchange = "calculate()" })

            </div>
        </div>
        <div class="form-row">
            <div class="form-lable">
                Tax %
            </div>
            <div class="form-input">
                @Html.TextBoxFor(c => c.Quote.Tax, new { @class = "form-control quo-tax", @onchange = "calculate()" })

            </div>
        </div>*@
    <div class="form-row">
        <div class="form-lable">
            @POS.Resources.Resource.Total
        </div>
        <div class="form-input">
            @Html.TextBoxFor(c => c.Quote.Total, new { @class = "form-control quo-total", @readonly = "readonly" })

        </div>
    </div>

    <input type="submit" class="btn btn-primary custombtn" value="SAVE" />
    <a href="/Home" class="btn btn-primary custombtn">@POS.Resources.Resource.Back</a>
}
<!-- Modal -->
<div class="modal fade" id="cusModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="myModalLabel">@POS.Resources.Resource.CreateCustomer</h4>
            </div>
            <div class="modal-body">
                @Html.Action("CreatePopup", "Customer")

            </div>
            <div class="modal-footer">

            </div>
        </div>
    </div>
</div>
<div class="modal fade image-modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="myModalLabel">@POS.Resources.Resource.Image</h4>
            </div>
            <div class="modal-body">

            </div>
            <div class="modal-footer">

            </div>
        </div>
    </div>
</div>
<div class="modal fade prices-modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="myModalLabel">@POS.Resources.Resource.Prices</h4>
            </div>
            <div class="modal-body">

            </div>
            <div class="modal-footer">

            </div>
        </div>
    </div>
</div>
<div class="modal fade print-modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title">@POS.Resources.Resource.Print</h4>
            </div>
            <div class="modal-body">
                <div>
                    @if (Model.User.Location.SiteName == "WALEED ELECTRONICS")
                    {
                        <input type="hidden" id="saleid" value="00000000-0000-0000-0000-000000000000" />
                        <button class="btn btn-default custombtn" onclick="printW()">A4</button>
                        <button class="btn btn-default custombtn" onclick="printAlwaqt()">Print Invoice</button>
                    }
                    else
                    {
                        <input type="hidden" id="saleid" value="00000000-0000-0000-0000-000000000000" />
                        <button class="btn btn-default custombtn" onclick="printA()">A4</button>
                        <button class="btn btn-default custombtn" onclick="printcrystal()">@POS.Resources.Resource.Invoice</button>
                    }

                    <button class="btn btn-default custombtn" onclick="cancelPrint()">@POS.Resources.Resource.Cancel</button>
                </div>
            </div>
            <div class="modal-footer">

            </div>
        </div>
    </div>
</div>
<script>


    function printcrystal() {

        var id = $('#saleid').val();
        var url = "@Url.Action("InvoicePrint", "Quotation")?id=" + id;
        var windowobject = window.open(url, "_blank");
        windowobject.onload = function () {
            windowobject.print();
            windowobject.document.close();

        }
    }

    var userfirstname = '@Model.User.FirstName';
    var lastname = '@Model.User.LastName';



    var username = userfirstname + ' ' + lastname;
    function cancelPrint() {
        $(".print-modal").modal("hide");
        $('.modal-backdrop').hide();
        successToast();
        getQuotations();
    }
    function printW() {
        cancelPrint();
        var name = $("#Quote_FKCustomerID:selected").text();
        var sr = $("#Quote_ReferenceNumber").val();
        var date = $("#Quote_QuoteDate").val();
        var sn = 0;
        var docprint = window.open("about:blank", "_blank");
        docprint.document.open();
        docprint.document.write('<html><head><title></title>');
        docprint.document.write('<style>span { margin:3px; }</style>');
        docprint.document.write('</head><body style="width:100%;">');
        docprint.document.write("<div style='float:left;width:100%;text-align:center;font-size:large'>WALEED ELECTRONICS</div>");
        docprint.document.write("<div style='float:left;width:100%;text-align:center;font-size:large'>QUOTATION</div>");
        docprint.document.write("<div style='float:left;width:100%;text-align:center;font-size:small'>Tel.: 011 4114443 </div>");
        docprint.document.write("<div style='float:left;width:100%;text-align:center;font-size:medium'> No : " + sr + " M/s: " + name + "</div>");
        docprint.document.write("<div style='float:left;width:100%;text-align:center;font-size:medium'> Date : " + date + " L.P.O. No.:</div>");
        $("#quotation-items tbody tr").each(function () {
            var itemno = $(this).find(".item-search").val();
            var sno = sn + 1;
            var desc = $(this).find(".sale-items").val();
            var qty = $(this).find(".sale-item-quantity").val();
            var price = $(this).find(".sale-item-price").val();
            var total = $(this).find(".sale-item-total").val();
            docprint.document.write("<div style='float:left;width:100%;text-align:left;font-size:small'><span style='float:left;'>" + sno + "</span><span style='float:left;'>" + itemno + "</span><span style='float:left;'>" + desc + "</span><span style='float:left;'>" + qty + "</span><span style='float:left;'>" + price + "</span><span style='float:left;'>" + total + "</span></div>");

        });
        var gTotal = $("#Quote_Total").val();
        var disc = "";
        docprint.document.write("<div style='float:left;width:100%;text-align:right;font-size:medium'>Discount: " + disc + "</div>");
        docprint.document.write("<div style='float:left;width:100%;text-align:right;font-size:medium'>Total: " + gTotal + "</div>");
        docprint.document.write('</body></html>');
        docprint.document.close();
        docprint.print();
        docprint.close();
    }
    function printA() {
        cancelPrint();
        var name = $("#Quote_FKCustomerID:selected").text();
        var sr = $("#Quote_ReferenceNumber").val();
        var date = $("#Quote_QuoteDate").val();
        var sn = 0;
        var docprint = window.open("about:blank", "_blank");
        docprint.document.open();
        docprint.document.write('<html><head><title></title>');
        docprint.document.write('<style>span { margin:3px; }</style>');
        docprint.document.write('</head><body style="width:100%;">');
        docprint.document.write("<div style='float:left;width:100%;text-align:center;font-size:large'>Title here.</div>");
        docprint.document.write("<div style='float:left;width:100%;text-align:center;font-size:large'>QUOTATION</div>");
        docprint.document.write("<div style='float:left;width:100%;text-align:center;font-size:small'>Tel.: 011-4111227</div>");
        docprint.document.write("<div style='float:left;width:100%;text-align:center;font-size:medium'> No : " + sr + " M/s: " + name + "</div>");
        docprint.document.write("<div style='float:left;width:100%;text-align:center;font-size:medium'> Date : " + date + " L.P.O. No.:</div>");
        $("#quotation-items tbody tr").each(function () {
            var itemno = $(this).find(".item-search").val();
            var sno = sn + 1;
            var desc = $(this).find(".sale-items").val();
            var qty = $(this).find(".sale-item-quantity").val();
            var price = $(this).find(".sale-item-price").val();
            var total = $(this).find(".sale-item-total").val();
            docprint.document.write("<div style='float:left;width:100%;text-align:left;font-size:small'><span style='float:left;'>" + sno + "</span><span style='float:left;'>" + itemno + "</span><span style='float:left;'>" + desc + "</span><span style='float:left;'>" + qty + "</span><span style='float:left;'>" + price + "</span><span style='float:left;'>" + total + "</span></div>");

        });
        var gTotal = $("#Quote_Total").val();
        var disc = "";
        docprint.document.write("<div style='float:left;width:100%;text-align:right;font-size:medium'>Discount: " + disc + "</div>");
        docprint.document.write("<div style='float:left;width:100%;text-align:right;font-size:medium'>Total: " + gTotal + "</div>");
        docprint.document.write('</body></html>');
        docprint.document.close();
        docprint.print();
        docprint.close();
    }
    function printReceipt() {
        cancelPrint();
        var name = $("#Quote_FKCustomerID:selected").text();
        var sr = $("#Quote_ReferenceNumber").val();
        var date = $("#Quote_QuoteDate").val();
        var sn = 0;
        var docprint = window.open("about:blank", "_blank");
        docprint.document.open();
        docprint.document.write('<html><head><title></title>');
        docprint.document.write('<style>span { margin:3px; }</style>');
        docprint.document.write('</head><body style="width:275px;">');
        docprint.document.write("<div style='float:left;width:100%;text-align:center;font-size:large'>Title here.</div>");
        docprint.document.write("<div style='float:left;width:100%;text-align:center;font-size:large'>QUOTATION</div>");
        docprint.document.write("<div style='float:left;width:100%;text-align:center;font-size:small'>Adress here</div>");
        docprint.document.write("<div style='float:left;width:100%;text-align:center;font-size:medium'> No : " + sr + " M/s: " + name + "</div>");
        docprint.document.write("<div style='float:left;width:100%;text-align:center;font-size:medium'> Date : " + date + " L.P.O. No.:</div>");
        $("#quotation-items tbody tr").each(function () {
            var itemno = $(this).find(".item-search").val();
            var sno = sn + 1;
            var desc = $(this).find(".sale-items").val();
            var qty = $(this).find(".sale-item-quantity").val();
            var price = $(this).find(".sale-item-price").val();
            var total = $(this).find(".sale-item-total").val();
            docprint.document.write("<div style='float:left;width:100%;text-align:left;font-size:small'><span style='float:left;'>" + sno + "</span><span style='float:left;'>" + itemno + "</span><span style='float:left;'>" + desc + "</span><span style='float:left;'>" + qty + "</span><span style='float:left;'>" + price + "</span><span style='float:left;'>" + total + "</span></div>");

        });
        var gTotal = $("#Quote_Total").val();
        var disc = "";
        docprint.document.write("<div style='float:left;width:100%;text-align:right;font-size:medium'>Discount: " + disc + "</div>");
        docprint.document.write("<div style='float:left;width:100%;text-align:right;font-size:medium'>Total: " + gTotal + "</div>");
        docprint.document.write('</body></html>');
        docprint.document.close();
        docprint.print();
        docprint.close();
    }

    /////////////////
    function printAlwaqt() {

        var name = $("#Quote_FKCustomerID :selected").text();
        var sr = $("#Quote_ReferenceNumber").val();
        var date = $("#Quote_QuoteDate").val();
        var sn = 0;

        var arr = []; // object Array  added by nasib

        var j = 1; // serial no of record(1 -> 9) per page
        var itemsInPage = 9;//item per page
        var disc = ""; var recivedby = ""; var gTotal = 0;
        var itemno = 0; var desc = ""; var qty = 0;
        var price = 0.0; var total = 0;
        var min_height = 103;
        var margin_top = 0; //sets margin from Top to set for page design


        $("#quotation-items tbody tr").each(function () { //get All Data from model dialog
            sn++;
            itemno = $(this).find(".item-search").val();
            desc = $(this).find(".sale-items").val();
            qty = $(this).find(".sale-item-quantity").val();
            price = $(this).find(".sale-item-price").val();
            total = $(this).find(".sale-item-total").val();
            gTotal = $("#Quote_Total").val();



            arr.push({ //push Data in object form in arr Array
                sn: sn,
                itemno: itemno,
                desc: desc,
                qty: qty,
                price: price,
                total: total,
                gTotal: gTotal,
                recivedby: username,
                disc: disc
            });
        });
        //print Starts from here
        var docprint = window.open("about:blank", "_blank");
        docprint.document.open();
        docprint.document.write('<html><head><title></title>');
        docprint.document.write('<style>html, body { height: 100%; width: 100%; margin: 0; }@@media screen {.pagebreak	{ border-top:1px dotted #999; }}@@media print {.pagebreak {page-break-after: always;}}</style>');
        docprint.document.write('</head><body>');

        for (var i = 0; i < arr.length; i++) {
            if (j == 1) {//if page starts of no of recoeds are equal to pagecount(9)


                docprint.document.write('<table style="width: 800px;height:540px;">');

                docprint.document.write('<tr style="height: 111px;"><th style="width:10%;"></th><th style="width: 11%;"></th><th style="width: 47%;"></th><th style="width: 9%;"></th><th style="width: 9%;"></th><th style="width: 14%;"></th></tr>');

                docprint.document.write('<tr style="height: 10px;"><td></td><td colspan="3">' + sr + '</td><td colspan="2">' + date + '</td></tr>');
                docprint.document.write('<tr style="height: 10px;"><td></td><td colspan="3"></td><td colspan="2">Quotations</td></tr>');
                docprint.document.write('<tr style="height:28px;"><td colspan="6"></td></tr>');

            } //body area for each record
            docprint.document.write('<tr style="height: 10px;"><td style="text-align: center">' + arr[i].sn + '</td><td>' + arr[i].itemno + '</td><td style="text-align: center;">' + (arr[i].desc).substring(0, 50) + '</td><td>' + arr[i].qty + '</td><td>' + arr[i].price + '</td><td>' + arr[i].total + '</td></tr>');
            if (j == itemsInPage || (i + 1) == sn) {// if no of record = 9 footer area starts here
                if (((i + 1) == sn) && (sn % itemsInPage > 0)) { //if no of record in last page is > 9 (page count) add some empty rows to cover the height
                    var loop_val = itemsInPage - (sn % itemsInPage);//no of empty rows to be added
                    for (var k = 0; k < loop_val ; k++) {
                        docprint.document.write('<tr style="height: 10px;"><td colspan="6">&nbsp;</td></tr>');
                    }
                }// common footer of each page
                docprint.document.write('<tr style="height: 20px;"><td colspan="5"></td><td>' + disc + '</td></tr>');
                docprint.document.write('<tr style="height:10px;"><td colspan="5"></td><td style="text-align:left;">' + gTotal + '</td></tr>');
                docprint.document.write('<tr style="height:20px;"><td colspan="2"></td><td colspan="2">' + recivedby + '</td></tr>');
                docprint.document.write('<tr style="height:0px;"><td colspan="2"></td><td colspan="4">&nbsp;</td></tr>');

                docprint.document.write('</table>');
                docprint.document.write('<div class="pagebreak"></div>');
                j = 1;
            }
            else {
                j++; // variable to check sr no of record wrt to page (1 -> 9)
            }
        } //for loop 'i' end here
        docprint.document.write('</body></html>');
        docprint.document.close();
        docprint.print();
        $(".print-modal").modal("hide");
    }

    function printWaleed() {
        debugger;
        var name = $("#Sale_FKCustomerID :selected").text();
        if (name == "") {
            name = $("#Sale_CustomerName").val();
        }
        var sr = $("#Sale_RefNO").val();
        var date = $("#Sale_SaleDate").val();
        var sn = 0;
        var pagesCount = ($("#sale-items tbody tr").length);
        var itemsInPage = 9;
        var docprint = window.open("about:blank", "_blank");
        docprint.document.open();
        debugger;
        docprint.document.write('<html><head><title></title>');
        docprint.document.write('</head><body>');
        $("#sale-items tbody tr").each(function () {
            if (sn % itemsInPage == 0) {
                debugger;
                docprint.document.write('<div style="width:800px;height:300px">');
                docprint.document.write("<div style='float:left;width:800px;margin-top:99px;'><span style='float:left;margin-left:30px;margin-bottom:10px'>" + sr + "</span><span style='float:right;margin-right:30px;margin-bottom:20px;'>" + date + "</span></div>");
                docprint.document.write("<div style='float:left;width:800px;margin-top:-13px;'><span style='float:left;margin-left:29px;;margin-bottom:10px'>" + name + "</span><span style='float:right;margin-right:123px;margin-bottom:20px;'>" + cash + "</span></div>");
                docprint.document.write('<div style="margin-top:25px;float:left;min-height:330px;position: relative;">');
            }
            var itemno = $(this).find(".item-search").val();
            var desc = $(this).find(".sale-items").val();
            var qty = $(this).find(".sale-item-quantity").val();
            var price = $(this).find(".sale-item-price").val();
            var total = $(this).find(".sale-item-total").val();
            docprint.document.write("<div style='float:left;width:800px;margin-top:9.5px;margin-left:10px;'><span style='float:left;left:0;text-align:left;width:5%;'>" + ++sn + "</span><span style='float:left;width:15%;'>" + itemno + "</span><span style='float:left;width:45%;'>" + desc + "</span><span style='float:left;width:10%;text-align:right; pading-right:5px;margin-right:16px;text-align:left'>" + qty + "</span><span style='float:left;width:10%;text-align:right; pading-right:5px;text-align:left'>" + price + "</span><span style='float:left;width:10%;margin-left:15px;text-align:right; pading-right:5px;text-align:left'>" + total + "</span></div>");

            if (sn % itemsInPage == 0 || sn == pagesCount) {
                var gTotal = $("#Sale_Total").val();
                var disc = $("#disc-amount").val();
                var recivedby = username;
                docprint.document.write("<div style='position: absolute;bottom:0;width:800px;text-align:right;'><div style='margin-right:45px;;margin-top:2px;padding-bottom:62px' !Important;>" + disc + "</div></div><br /><div style='position: absolute;bottom:0;width:800px;text-align:right;'><div style='margin-right:45px;margin-left:15px;padding-bottom:5px !Important;'>" + gTotal + "</div><div style='margin-right:550px !Important;padding-bottom:5px;margin-top:10px !Important;'>" + recivedby + "</div></div>");
                docprint.document.write('</div>');
            }
        });
        docprint.document.write('</div></body></html>');
        docprint.document.close();
        docprint.print();
        //docprint.close();
        $(".print-modal").modal("hide");
    }

    //function printAlwaqt() {
    //    cancelPrint();
    //    var name = $("#Quote_FKCustomerID:selected").text();
    //    var sr = $("#Quote_ReferenceNumber").val();
    //    var date = $("#Quote_QuoteDate").val();
    //    var sn = 0;
    //    var docprint = window.open("about:blank", "_blank");
    //    docprint.document.open();
    //    docprint.document.write('<html><head><title></title>');
    //    docprint.document.write('</head><body style="width:800px;height:300px">');
    //    docprint.document.write("<div style='float:left;width:800px;margin-top:110px;'><span style='float:left;margin-left:55px;'>" + sr + "</span><span style='float:right;margin-right:30px;margin-bottom:10px;'>" + date + "</span></div>");
    //    docprint.document.write("<div style='float:left;width:800px;'><span style='float:left;margin-left:55px;;margin-bottom:5px;'>" + name + "</span><span style='float:right;margin-right:30px;margin-bottom:5px;'></span></div>");
    //    docprint.document.write('<div style="margin-top:50px;float:left;min-height:335px;position: relative;">');
    //    $("#quotation-items tbody tr").each(function () {
    //        var itemno = $(this).find(".item-search").val();
    //        var sno = sn + 1;
    //        var desc = $(this).find(".sale-items").val();
    //        var qty = $(this).find(".sale-item-quantity").val();
    //        var price = $(this).find(".sale-item-price").val();
    //        var total = $(this).find(".sale-item-total").val();
    //        docprint.document.write("<div style='float:left;width:800px;'><span style='float:left;left:0;text-align:left;width:5%;'>" + sno + "</span><span style='float:left;width:15%;'>" + itemno + "</span><span style='float:left;width:45%;'>" + desc + "</span><span style='float:left;width:10%;text-align:right; pading-right:5px;'>" + qty + "</span><span style='float:left;width:10%;text-align:right; pading-right:5px;'>" + price + "</span><span style='float:left;width:10%;margin-left:15px;text-align:right; pading-right:5px;'>" + total + "</span></div>");
    //    });

    //    //docprint.document.write("<div style='float:left;width:800px;'><span style='float:left;left:0;text-align:left;width:5%;'>2</span><span style='float:left;width:15%;'>10100007</span><span style='float:left;width:45%;'>This is test description</span><span style='float:left;width:10%;text-align:right; pading-right:5px;'>10</span><span style='float:left;width:10%;text-align:right; pading-right:5px;'>30</span><span style='float:left;width:10%;margin-left:15px;text-align:right; pading-right:5px;'>300</span></div>");
    //    //docprint.document.write("<div style='float:left;width:800px;'><span style='float:left;left:0;text-align:left;width:5%;'>3</span><span style='float:left;width:15%;'>10100007</span><span style='float:left;width:45%;'>This is test description</span><span style='float:left;width:10%;text-align:right; pading-right:5px;'>10</span><span style='float:left;width:10%;text-align:right; pading-right:5px;'>30</span><span style='float:left;width:10%;margin-left:15px;text-align:right; pading-right:5px;'>300</span></div>");
    //    //docprint.document.write("<div style='float:left;width:800px;'><span style='float:left;left:0;text-align:left;width:5%;'>4</span><span style='float:left;width:15%;'>10100007</span><span style='float:left;width:45%;'>This is test description</span><span style='float:left;width:10%;text-align:right; pading-right:5px;'>10</span><span style='float:left;width:10%;text-align:right; pading-right:5px;'>30</span><span style='float:left;width:10%;margin-left:15px;text-align:right; pading-right:5px;'>300</span></div>");
    //    //docprint.document.write("<div style='float:left;width:800px;'><span style='float:left;left:0;text-align:left;width:5%;'>5</span><span style='float:left;width:15%;'>10100007</span><span style='float:left;width:45%;'>This is test description</span><span style='float:left;width:10%;text-align:right; pading-right:5px;'>10</span><span style='float:left;width:10%;text-align:right; pading-right:5px;'>30</span><span style='float:left;width:10%;margin-left:15px;text-align:right; pading-right:5px;'>300</span></div>");
    //    //docprint.document.write("<div style='float:left;width:800px;'><span style='float:left;left:0;text-align:left;width:5%;'>6</span><span style='float:left;width:15%;'>10100007</span><span style='float:left;width:45%;'>This is test description</span><span style='float:left;width:10%;text-align:right; pading-right:5px;'>10</span><span style='float:left;width:10%;text-align:right; pading-right:5px;'>30</span><span style='float:left;width:10%;margin-left:15px;text-align:right; pading-right:5px;'>300</span></div>");
    //    //docprint.document.write("<div style='float:left;width:800px;'><span style='float:left;left:0;text-align:left;width:5%;'>7</span><span style='float:left;width:15%;'>10100007</span><span style='float:left;width:45%;'>This is test description</span><span style='float:left;width:10%;text-align:right; pading-right:5px;'>10</span><span style='float:left;width:10%;text-align:right; pading-right:5px;'>30</span><span style='float:left;width:10%;margin-left:15px;text-align:right; pading-right:5px;'>300</span></div>");
    //    //docprint.document.write("<div style='float:left;width:800px;'><span style='float:left;left:0;text-align:left;width:5%;'>8</span><span style='float:left;width:15%;'>10100007</span><span style='float:left;width:45%;'>This is test description</span><span style='float:left;width:10%;text-align:right; pading-right:5px;'>10</span><span style='float:left;width:10%;text-align:right; pading-right:5px;'>30</span><span style='float:left;width:10%;margin-left:15px;text-align:right; pading-right:5px;'>300</span></div>");
    //    //docprint.document.write("<div style='float:left;width:800px;'><span style='float:left;left:0;text-align:left;width:5%;'>9</span><span style='float:left;width:15%;'>10100007</span><span style='float:left;width:45%;'>This is test description</span><span style='float:left;width:10%;text-align:right; pading-right:5px;'>10</span><span style='float:left;width:10%;text-align:right; pading-right:5px;'>30</span><span style='float:left;width:10%;margin-left:15px;text-align:right; pading-right:5px;'>300</span></div>");
    //    //docprint.document.write("<div style='float:left;width:800px;'><span style='float:left;left:0;text-align:left;width:5%;'>10</span><span style='float:left;width:15%;'>10100007</span><span style='float:left;width:45%;'>This is test description</span><span style='float:left;width:10%;text-align:right; pading-right:5px;'>10</span><span style='float:left;width:10%;text-align:right; pading-right:5px;'>30</span><span style='float:left;width:10%;margin-left:15px;text-align:right; pading-right:5px;'>300</span></div>");
    //    //docprint.document.write("<div style='float:left;width:800px;'><span style='float:left;left:0;text-align:left;width:5%;'>11</span><span style='float:left;width:15%;'>10100007</span><span style='float:left;width:45%;'>This is test description</span><span style='float:left;width:10%;text-align:right; pading-right:5px;'>10</span><span style='float:left;width:10%;text-align:right; pading-right:5px;'>30</span><span style='float:left;width:10%;margin-left:15px;text-align:right; pading-right:5px;'>300</span></div>");
    //    //docprint.document.write("<div style='float:left;width:800px;'><span style='float:left;left:0;text-align:left;width:5%;'>12</span><span style='float:left;width:15%;'>10100007</span><span style='float:left;width:45%;'>This is test description</span><span style='float:left;width:10%;text-align:right; pading-right:5px;'>10</span><span style='float:left;width:10%;text-align:right; pading-right:5px;'>30</span><span style='float:left;width:10%;margin-left:15px;text-align:right; pading-right:5px;'>300</span></div>");
    //    //docprint.document.write("<div style='float:left;width:800px;'><span style='float:left;left:0;text-align:left;width:5%;'>13</span><span style='float:left;width:15%;'>10100007</span><span style='float:left;width:45%;'>This is test description</span><span style='float:left;width:10%;text-align:right; pading-right:5px;'>10</span><span style='float:left;width:10%;text-align:right; pading-right:5px;'>30</span><span style='float:left;width:10%;margin-left:15px;text-align:right; pading-right:5px;'>300</span></div>");
    //    var gTotal = $("#Quote_Total").val();
    //    var disc = "";
    //    docprint.document.write("<div style='position: absolute;bottom:0;width:800px;text-align:right'><div style='float:right;'>" + disc + "</div><br /><br /><div style='float:right'>" + gTotal + "</div></div>");
    //    docprint.document.write('</div></body></html>');
    //    docprint.document.close();
    //    docprint.print();
    //    docprint.close();
    //}
    //function printWaleed() {
    //    cancelPrint();
    //    var name = $("#Quote_FKCustomerID:selected").text();
    //    var sr = $("#Quote_ReferenceNumber").val();
    //    var date = $("#Quote_QuoteDate").val();
    //    var sn = 0;
    //    var docprint = window.open("about:blank", "_blank");
    //    docprint.document.open();
    //    docprint.document.write('<html><head><title></title>');
    //    docprint.document.write('</head><body style="width:800px;height:300px">');
    //    docprint.document.write("<div style='float:left;width:800px;margin-top:75px;'><span style='float:left;margin-left:55px;'>" + sr + "</span><span style='float:right;margin-right:30px;margin-bottom:10px;'>" + date + "</span></div>");
    //    docprint.document.write("<div style='float:left;width:800px;'><span style='float:left;margin-left:55px;;margin-bottom:5px;'>" + name + "</span><span style='float:right;margin-right:30px;margin-bottom:5px;'></span></div>");
    //    docprint.document.write('<div style="margin-top:50px;float:left;min-height:335px;position: relative;">');
    //    $("#sale-items tbody tr").each(function () {
    //        var itemno = $(this).find(".item-search").val();
    //        var sno = sn + 1;
    //        var desc = $(this).find(".sale-items").val();
    //        var qty = $(this).find(".sale-item-quantity").val();
    //        var price = $(this).find(".sale-item-price").val();
    //        var total = $(this).find(".sale-item-total").val();
    //        docprint.document.write("<div style='float:left;width:800px;'><span style='float:left;left:0;text-align:left;width:5%;'>" + sno + "</span><span style='float:left;width:15%;'>" + itemno + "</span><span style='float:left;width:45%;'>" + desc + "</span><span style='float:left;width:10%;text-align:right; pading-right:5px;'>" + qty + "</span><span style='float:left;width:10%;text-align:right; pading-right:5px;'>" + price + "</span><span style='float:left;width:10%;margin-left:15px;text-align:right; pading-right:5px;'>" + total + "</span></div>");
    //    });
    //    //docprint.document.write("<div style='float:left;width:800px;'><span style='float:left;left:0;text-align:left;width:5%;'>1</span><span style='float:left;width:15%;'>10100007</span><span style='float:left;width:45%;'>This is test description</span><span style='float:left;width:10%;text-align:right; pading-right:5px;'>10</span><span style='float:left;width:10%;text-align:right; pading-right:5px;'>30</span><span style='float:left;width:10%;margin-left:15px;text-align:right; pading-right:5px;'>300</span></div>");
    //    //docprint.document.write("<div style='float:left;width:800px;'><span style='float:left;left:0;text-align:left;width:5%;'>2</span><span style='float:left;width:15%;'>10100007</span><span style='float:left;width:45%;'>This is test description</span><span style='float:left;width:10%;text-align:right; pading-right:5px;'>10</span><span style='float:left;width:10%;text-align:right; pading-right:5px;'>30</span><span style='float:left;width:10%;margin-left:15px;text-align:right; pading-right:5px;'>300</span></div>");
    //    //docprint.document.write("<div style='float:left;width:800px;'><span style='float:left;left:0;text-align:left;width:5%;'>3</span><span style='float:left;width:15%;'>10100007</span><span style='float:left;width:45%;'>This is test description</span><span style='float:left;width:10%;text-align:right; pading-right:5px;'>10</span><span style='float:left;width:10%;text-align:right; pading-right:5px;'>30</span><span style='float:left;width:10%;margin-left:15px;text-align:right; pading-right:5px;'>300</span></div>");
    //    //docprint.document.write("<div style='float:left;width:800px;'><span style='float:left;left:0;text-align:left;width:5%;'>4</span><span style='float:left;width:15%;'>10100007</span><span style='float:left;width:45%;'>This is test description</span><span style='float:left;width:10%;text-align:right; pading-right:5px;'>10</span><span style='float:left;width:10%;text-align:right; pading-right:5px;'>30</span><span style='float:left;width:10%;margin-left:15px;text-align:right; pading-right:5px;'>300</span></div>");
    //    //docprint.document.write("<div style='float:left;width:800px;'><span style='float:left;left:0;text-align:left;width:5%;'>5</span><span style='float:left;width:15%;'>10100007</span><span style='float:left;width:45%;'>This is test description</span><span style='float:left;width:10%;text-align:right; pading-right:5px;'>10</span><span style='float:left;width:10%;text-align:right; pading-right:5px;'>30</span><span style='float:left;width:10%;margin-left:15px;text-align:right; pading-right:5px;'>300</span></div>");
    //    //docprint.document.write("<div style='float:left;width:800px;'><span style='float:left;left:0;text-align:left;width:5%;'>6</span><span style='float:left;width:15%;'>10100007</span><span style='float:left;width:45%;'>This is test description</span><span style='float:left;width:10%;text-align:right; pading-right:5px;'>10</span><span style='float:left;width:10%;text-align:right; pading-right:5px;'>30</span><span style='float:left;width:10%;margin-left:15px;text-align:right; pading-right:5px;'>300</span></div>");
    //    //docprint.document.write("<div style='float:left;width:800px;'><span style='float:left;left:0;text-align:left;width:5%;'>7</span><span style='float:left;width:15%;'>10100007</span><span style='float:left;width:45%;'>This is test description</span><span style='float:left;width:10%;text-align:right; pading-right:5px;'>10</span><span style='float:left;width:10%;text-align:right; pading-right:5px;'>30</span><span style='float:left;width:10%;margin-left:15px;text-align:right; pading-right:5px;'>300</span></div>");
    //    //docprint.document.write("<div style='float:left;width:800px;'><span style='float:left;left:0;text-align:left;width:5%;'>8</span><span style='float:left;width:15%;'>10100007</span><span style='float:left;width:45%;'>This is test description</span><span style='float:left;width:10%;text-align:right; pading-right:5px;'>10</span><span style='float:left;width:10%;text-align:right; pading-right:5px;'>30</span><span style='float:left;width:10%;margin-left:15px;text-align:right; pading-right:5px;'>300</span></div>");
    //    //docprint.document.write("<div style='float:left;width:800px;'><span style='float:left;left:0;text-align:left;width:5%;'>9</span><span style='float:left;width:15%;'>10100007</span><span style='float:left;width:45%;'>This is test description</span><span style='float:left;width:10%;text-align:right; pading-right:5px;'>10</span><span style='float:left;width:10%;text-align:right; pading-right:5px;'>30</span><span style='float:left;width:10%;margin-left:15px;text-align:right; pading-right:5px;'>300</span></div>");
    //    //docprint.document.write("<div style='float:left;width:800px;'><span style='float:left;left:0;text-align:left;width:5%;'>10</span><span style='float:left;width:15%;'>10100007</span><span style='float:left;width:45%;'>This is test description</span><span style='float:left;width:10%;text-align:right; pading-right:5px;'>10</span><span style='float:left;width:10%;text-align:right; pading-right:5px;'>30</span><span style='float:left;width:10%;margin-left:15px;text-align:right; pading-right:5px;'>300</span></div>");
    //    //docprint.document.write("<div style='float:left;width:800px;'><span style='float:left;left:0;text-align:left;width:5%;'>11</span><span style='float:left;width:15%;'>10100007</span><span style='float:left;width:45%;'>This is test description</span><span style='float:left;width:10%;text-align:right; pading-right:5px;'>10</span><span style='float:left;width:10%;text-align:right; pading-right:5px;'>30</span><span style='float:left;width:10%;margin-left:15px;text-align:right; pading-right:5px;'>300</span></div>");
    //    //docprint.document.write("<div style='float:left;width:800px;'><span style='float:left;left:0;text-align:left;width:5%;'>12</span><span style='float:left;width:15%;'>10100007</span><span style='float:left;width:45%;'>This is test description</span><span style='float:left;width:10%;text-align:right; pading-right:5px;'>10</span><span style='float:left;width:10%;text-align:right; pading-right:5px;'>30</span><span style='float:left;width:10%;margin-left:15px;text-align:right; pading-right:5px;'>300</span></div>");
    //    //docprint.document.write("<div style='float:left;width:800px;'><span style='float:left;left:0;text-align:left;width:5%;'>13</span><span style='float:left;width:15%;'>10100007</span><span style='float:left;width:45%;'>This is test description</span><span style='float:left;width:10%;text-align:right; pading-right:5px;'>10</span><span style='float:left;width:10%;text-align:right; pading-right:5px;'>30</span><span style='float:left;width:10%;margin-left:15px;text-align:right; pading-right:5px;'>300</span></div>");

    //    var gTotal = $("#Quote_Total").val();
    //    var disc = "";
    //    docprint.document.write("<div style='position: absolute;bottom:0;width:800px;text-align:right'><div style='float:right;'>" + disc + "</div><br /><br /><div style='float:right'>" + gTotal + "</div></div>");

    //    docprint.document.write('</div></body></html>');
    //    docprint.document.close();
    //    docprint.print();
    //    docprint.close();
    //}



    $(document).ready(function () {
        $("#Quote_QuoteExpiry").val("");
        var $select2 = $("#Sale_FKLocationID").selectize();
        $select2[0].selectize.setValue('@POS.Models.Sessions.Util.GetCurrentUserLocationID()');
        $(".datepicker").kendoDatePicker(datePickerOptions);

        select_saleitemunit = [];
        var dropDiv = $("#Quote_Items0_FkUnitID");
        dropDiv.kendoDropDownList({
            optionLabel: "Please select",
            dataTextField: "Text",
            dataValueField: "Value",
            dataSource: {
                transport: {
                    read: {
                        url: '/Sale/GetItemUnitsByGroupForSale',
                        data: function () {
                            return { groupID: saleItemUnitgroupID }
                        },
                    }
                }
            },
            change: function (e) {
                var ref = $(e.sender.element.context).parent();
                $(ref).parent().parent().find(".sale-item-changed-price").val(0);
                setItemTotal(ref);
            }
        });

        select_saleitemunit[0] = dropDiv.data("kendoDropDownList");


        $('form').removeData('validator');
        $('form').removeData('unobtrusiveValidation');
        $.validator.unobtrusive.parse('form');
        var options = {
            beforeSubmit: function (msg) {
                if ($("#Quote_FKCustomerID").val().trim() == "") {
                    $().toastmessage('showToast', {
                        text: "Please select a customer",
                        sticky: false,
                        position: 'bottom-right',
                        type: 'error'
                    });
                    return false;
                }
                if (msg) {
                    var list = msg;
                    var rows = $('#quotation-items >tbody >tr');
                    $.each(rows, function (index, item) {
                        if (item) {
                            list.push({ name: "Quote.Items[" + index + "].FkUnitID", value: select_saleitemunit[index].value() });
                        }
                    });
                    msg = list;
                }
                blockUI();
                $(".btn").prop("disabled", true);
            },
            success: function (msg) {
                unblockUI();
                $(".btn").prop("disabled", false);
                if (msg.saleid != "00000000-0000-0000-0000-000000000000") {
                    $('#saleid').val(msg.saleid);
                    $(".print-modal").modal("show");

                }

            },

            error: function (jqXHR, textStatus, errorThrown) {
                handleErrors(textStatus);
                unblockUI();
                $(".btn").prop("disabled", false);

            }
        };
        $('#quo-form').ajaxForm(options);
        $('select').selectize();
        try {

            $select1 = $("#Sale_FKLocationID").selectize();
            $("#Sale_FKLocationID").val('@Model.getAllLocations(Model.User).Where(x=>x.Value == Model.User.LocationID.ToString()).First().Value');
            $select1[0].selectize.setValue('@Model.getAllLocations(Model.User).Where(x=>x.Value == Model.User.LocationID.ToString()).First().Value');

        } catch (e) {
            //alert(e.message);
        }
    });
    $('select').selectize({
        create: function (input, callback) {

        },
        sortField: 'text'
    });
    applyAutoComplete("Qu-item-0");
</script>